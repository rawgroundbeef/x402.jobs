---
phase: 06-refund-badge
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - public/badges/refund-protected.svg
  - public/badges/refund-protected-dark.svg
  - public/badges/shield-icon.svg
  - src/components/pages/ResourceDetailPage/ResourceDetailPage.tsx
  - src/components/ResourceCard/ResourceCard.tsx
  - src/components/modals/ResourceInteractionModal.tsx
  - src/components/pages/ResourcesListPage/ResourcesListPage.tsx
autonomous: true

must_haves:
  truths:
    - "Resource detail page shows 'Refund Protected' badge when supports_refunds is true"
    - "Resource cards in lists show 'Refund' badge when supports_refunds is true"
    - "Badge does not appear when supports_refunds is false or missing"
    - "Badge styling matches OpenFacilitator brand guidelines (blue theme)"
  artifacts:
    - path: "public/badges/refund-protected.svg"
      provides: "Official OpenFacilitator badge for light theme"
    - path: "public/badges/refund-protected-dark.svg"
      provides: "Official OpenFacilitator badge for dark theme"
    - path: "public/badges/shield-icon.svg"
      provides: "Compact shield icon for card badges"
    - path: "src/components/pages/ResourceDetailPage/ResourceDetailPage.tsx"
      provides: "Refund badge in stats row"
      contains: "supports_refunds"
    - path: "src/components/ResourceCard/ResourceCard.tsx"
      provides: "Refund badge in card actions"
      contains: "supports_refunds"
  key_links:
    - from: "ResourceDetailPage.tsx"
      to: "resource.supports_refunds"
      via: "conditional render"
      pattern: "resource\\.supports_refunds"
    - from: "ResourceCard.tsx"
      to: "resource.supports_refunds"
      via: "conditional render"
      pattern: "resource\\.supports_refunds"
---

<objective>
Add OpenFacilitator "Refund Protected" badge to resources when `supports_refunds: true` in the API response.

Purpose: Show users which resources support refunds via OpenFacilitator, building trust and encouraging usage of refund-protected resources.

Output: Badge displays on resource detail pages and resource cards when the resource has refund support enabled.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-refund-badge/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Download OpenFacilitator badge assets</name>
  <files>
    public/badges/refund-protected.svg
    public/badges/refund-protected-dark.svg
    public/badges/shield-icon.svg
  </files>
  <action>
Create `public/badges/` directory and download the official OpenFacilitator badge assets.

Since external URLs may not be accessible, create the badge SVGs inline following OpenFacilitator brand guidelines:

1. **refund-protected.svg** - Standard badge for light theme:
   - Blue background (#0B64F4)
   - White text and shield icon
   - Text: "Refund Protected"
   - Minimum 24px height, ~120px width

2. **refund-protected-dark.svg** - Dark theme variant:
   - White background (#FFFFFF)
   - Blue text and shield icon (#0B64F4)
   - Same dimensions

3. **shield-icon.svg** - Compact shield icon only:
   - Blue fill (#0B64F4)
   - 24x24 viewBox
   - Simple shield shape with checkmark

Use simple, clean SVG markup. The shield icon should be a shield shape with a checkmark inside.
</action>
<verify> - `ls -la public/badges/` shows all three SVG files - Each file is valid SVG (can open in browser) - Colors match brand: #0B64F4 (blue), #FFFFFF (white)
</verify>
<done>Three badge SVG files exist in public/badges/ with correct branding</done>
</task>

<task type="auto">
  <name>Task 2: Add refund badge to ResourceDetailPage and ResourceCard</name>
  <files>
    src/components/pages/ResourceDetailPage/ResourceDetailPage.tsx
    src/components/ResourceCard/ResourceCard.tsx
    src/components/modals/ResourceInteractionModal.tsx
    src/components/pages/ResourcesListPage/ResourcesListPage.tsx
  </files>
  <action>
Update interfaces and add badge rendering following the existing A2A badge pattern.

**1. ResourceDetailPage.tsx:**

- Add `supports_refunds?: boolean` to ResourceData interface (around line 92, after `is_a2a`)
- Add refund badge in stats row (after A2A badge, around line 939-945):
  ```tsx
  {
    resource.supports_refunds && (
      <>
        <span className="mx-2">â€¢</span>
        <span className="inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-bold bg-blue-500/15 text-blue-600 dark:text-blue-400 border border-blue-500/20">
          <img src="/badges/shield-icon.svg" alt="" className="h-3 w-3 mr-1" />
          Refund Protected
        </span>
      </>
    );
  }
  ```
- Add similar badge in the "Try It" section info area (around line 983-990, after A2A section)

**2. ResourceCard.tsx:**

- Add `supports_refunds?: boolean` to ResourceCardData interface (line 33, after `is_a2a`)
- Add compact refund badge in actions row (after A2A badge, around line 199):
  ```tsx
  {
    resource.supports_refunds && (
      <span
        className="inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-semibold bg-blue-500/15 text-blue-600 dark:text-blue-400 border border-blue-500/20"
        title="OpenFacilitator Refund Protected"
      >
        <img src="/badges/shield-icon.svg" alt="" className="h-3 w-3 mr-0.5" />
        Refund
      </span>
    );
  }
  ```

**3. ResourceInteractionModal.tsx:**

- Add `supports_refunds?: boolean` to Resource interface (around line 215, after `is_a2a`)
- Add refund badge section after A2A badge (around line 826-835):
  ```tsx
  {
    resource.supports_refunds && (
      <div className="flex items-center gap-2 p-2 bg-blue-500/10 border border-blue-500/20 rounded-lg">
        <span className="inline-flex items-center px-2 py-0.5 rounded text-xs font-bold bg-blue-500/20 text-blue-600 dark:text-blue-400 border border-blue-500/30">
          <img
            src="/badges/shield-icon.svg"
            alt=""
            className="h-3.5 w-3.5 mr-1"
          />
          Refund Protected
        </span>
        <span className="text-xs text-blue-600 dark:text-blue-400">
          This resource supports refunds via OpenFacilitator
        </span>
      </div>
    );
  }
  ```

**4. ResourcesListPage.tsx:**

- Add `supports_refunds?: boolean` to ListResource interface (around line 40, after `is_a2a`)

**Style notes:**

- Use blue color scheme (bg-blue-500/15, text-blue-600, dark:text-blue-400, border-blue-500/20)
- Follow A2A badge pattern exactly but with blue instead of violet
- Compact version in cards uses "Refund", full version uses "Refund Protected"
  </action>
  <verify> - `npm run build` passes without TypeScript errors - Badge conditionally renders (only when supports_refunds is true) - Grep confirms: `grep -n "supports_refunds" src/components/pages/ResourceDetailPage/ResourceDetailPage.tsx` - Grep confirms: `grep -n "supports_refunds" src/components/ResourceCard/ResourceCard.tsx`
  </verify>
  <done> - ResourceData interface includes supports_refunds field - ResourceCardData interface includes supports_refunds field - Badge renders on detail page when supports_refunds is true - Badge renders on cards when supports_refunds is true - Badge does not render when supports_refunds is false/missing
  </done>
  </task>

</tasks>

<verification>
1. **Build check:** `npm run build` completes successfully
2. **Interface check:** Both ResourceData and ResourceCardData have supports_refunds field
3. **Badge assets check:** `ls public/badges/` shows three SVG files
4. **Conditional render check:** Badge JSX wrapped in `{resource.supports_refunds && ...}`
5. **Style check:** Blue color scheme matches OpenFacilitator brand (#0B64F4)
</verification>

<success_criteria>

1. Build passes with no TypeScript errors
2. Badge appears on resource detail page when supports_refunds is true
3. Badge appears on resource cards when supports_refunds is true
4. Badge does not appear when supports_refunds is false or undefined
5. Badge styling uses blue theme consistent with OpenFacilitator brand
6. All three badge SVG assets are present in public/badges/
   </success_criteria>

<output>
After completion, create `.planning/phases/06-refund-badge/06-01-SUMMARY.md`
</output>
