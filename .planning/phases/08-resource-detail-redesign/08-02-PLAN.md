---
phase: 08-resource-detail-redesign
plan: 02
type: execute
wave: 2
depends_on: ["08-01"]
files_modified:
  - src/components/pages/ResourceDetailPage/ResourceDetailPage.tsx
autonomous: true

must_haves:
  truths:
    - "Stats bar + CTAs + refund note grouped in a subtle card container"
    - "Run button shows price inline (e.g., 'Run ($0.10)')"
    - "Price does NOT appear elsewhere on the page (no duplication)"
    - "Refund badge merged with attribution into single line below CTAs"
    - "Primary CTAs positioned after stats (stats provide context before action)"
  artifacts:
    - path: "src/components/pages/ResourceDetailPage/ResourceDetailPage.tsx"
      provides: "Complete redesigned layout with action zone card"
      contains: "Action Zone"
  key_links:
    - from: "ResourceDetailPage.tsx"
      to: "@repo/ui/card"
      via: "Card import for action zone"
      pattern: "Card.*bg-muted/30"
    - from: "ResourceDetailPage.tsx"
      to: "@repo/ui/tooltip"
      via: "Tooltip for refund explanation"
      pattern: "Tooltip.*Refund Protected"
---

<objective>
Create action zone card containing stats bar, CTAs, and refund note. Remove price duplication and improve visual grouping.

Purpose: Group decision-related elements (stats, CTAs, trust signals) into a clear "action zone" so users have all information needed to make a decision in one visual unit. Eliminate redundant price displays and merge refund badge with attribution.

Output: Fully redesigned ResourceDetailPage with improved information hierarchy and visual grouping.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-resource-detail-redesign/08-CONTEXT.md
@.planning/phases/08-resource-detail-redesign/08-RESEARCH.md
@.planning/phases/08-resource-detail-redesign/08-01-SUMMARY.md
@src/components/pages/ResourceDetailPage/ResourceDetailPage.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create action zone card with stats + CTAs + refund note</name>
  <files>src/components/pages/ResourceDetailPage/ResourceDetailPage.tsx</files>
  <action>
Restructure the "Try It Section" area (around lines 981-1435) into a contained action zone:

1. **Add Card and Tooltip imports** (if not already present):

   ```typescript
   import { Card } from "@repo/ui/card";
   import { Tooltip } from "@repo/ui/tooltip";
   ```

2. **Create the Action Zone card** replacing current layout:

   The new structure flows: Header -> Description -> [Action Zone Card] -> Form Fields -> Output -> Tabs

   ```tsx
   {
     /* Action Zone - Stats + CTAs + Trust Signals */
   }
   <Card className="p-6 bg-muted/30 border-border/50 mb-8">
     {/* Stats Bar */}
     <div className="flex flex-wrap items-center gap-x-4 gap-y-2 text-sm mb-4">
       {/* Success Rate (with tier from Plan 01) */}
       {(() => {
         const tier = getSuccessRateTier(successRateInfo.rate!);
         const totalCalls =
           (resource?.success_count_30d ?? 0) +
           (resource?.failure_count_30d ?? 0);

         if (successRateInfo.isNew) {
           return (
             <span className="inline-flex items-center px-1.5 py-0.5 rounded bg-muted text-xs font-medium">
               New
             </span>
           );
         }

         return (
           <span
             className={`inline-flex items-center gap-1 font-medium ${tier.color}`}
           >
             {tier.showWarning && <AlertTriangle className="w-3.5 h-3.5" />}
             {successRateInfo.text} success
             <span className="font-normal text-muted-foreground">
               ({totalCalls} calls)
             </span>
           </span>
         );
       })()}

       <span className="text-muted-foreground/50">|</span>

       {/* Network */}
       <span className="inline-flex items-center gap-1 text-muted-foreground">
         <ChainIcon
           network={resource.network}
           className={`h-3.5 w-3.5 ${getNetwork(resource.network).id === "base" ? "text-blue-500" : "text-purple-500"}`}
         />
         {getNetwork(resource.network).name}
       </span>

       {/* A2A badge inline */}
       {resource.is_a2a && (
         <>
           <span className="text-muted-foreground/50">|</span>
           <span className="inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-bold bg-violet-500/15 text-violet-600 dark:text-violet-400 border border-violet-500/20">
             A2A
           </span>
         </>
       )}

       {/* Owner earnings (only for owners) */}
       {canEdit && totalEarned > 0 && (
         <>
           <span className="text-muted-foreground/50">|</span>
           <span className="inline-flex items-center px-2 py-0.5 rounded-full bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 text-xs font-semibold">
             $
             {totalEarned > 1000
               ? `${(totalEarned / 1000).toFixed(1)}k`
               : totalEarned.toFixed(2)}{" "}
             earned
           </span>
         </>
       )}
     </div>

     {/* CTAs */}
     <div className="flex gap-2 mb-3">
       <Button
         variant="outline"
         onClick={handleCreateJob}
         disabled={isCreatingJob || !user}
       >
         {isCreatingJob ? (
           <>
             <Loader2 className="h-4 w-4 animate-spin mr-2" />
             Creating...
           </>
         ) : (
           "Use in Job"
         )}
       </Button>

       <Button
         onClick={handleSubmit}
         disabled={
           isSubmitting ||
           lro.isPolling ||
           (isPromptTemplate ? !isPtFormValid : hasInputs && !isFormValid) ||
           !user
         }
       >
         {isSubmitting ? (
           <>
             <Loader2 className="h-4 w-4 animate-spin mr-2" />
             Running...
           </>
         ) : lro.isPolling ? (
           <>
             <Loader2 className="h-4 w-4 animate-spin mr-2" />
             Processing...
           </>
         ) : !user ? (
           "Login to Run"
         ) : isFree ? (
           "Run (Free)"
         ) : (
           `Run (${priceDisplay})`
         )}
       </Button>
     </div>

     {/* Refund + Attribution line (merged) */}
     {resource.supports_refunds && (
       <p className="text-xs text-muted-foreground flex items-center gap-1.5">
         <img src="/badges/shield-icon.svg" alt="" className="h-4 w-4" />
         <Tooltip
           content={
             <>
               Refunds provided by{" "}
               <a
                 href="https://openfacilitator.io"
                 target="_blank"
                 rel="noopener noreferrer"
                 className="underline hover:text-blue-300"
               >
                 OpenFacilitator.io
               </a>
               . If the request fails, you&apos;ll be automatically refunded.
             </>
           }
         >
           <span className="cursor-help underline decoration-dotted underline-offset-2">
             Refund Protected
           </span>
         </Tooltip>{" "}
         via{" "}
         <a
           href="https://openfacilitator.io"
           target="_blank"
           rel="noopener noreferrer"
           className="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400"
         >
           OpenFacilitator
         </a>
       </p>
     )}
   </Card>;
   ```

3. **Remove the old separate elements**:
   - Remove standalone earnings pill from header (now in action zone for owners)
   - Remove old inline stats line from header (around lines 915-949)
   - Remove old A2A badge block (around lines 983-993)
   - Remove old Refund Badge block (around lines 995-1017)
   - Remove old Action Buttons section (around lines 1244-1294)
   - Remove price from stats line in header (price is now only in Run button)

4. **Reorder the page sections**:

   ```
   Header (avatar, title, URL, owner info, description)
   ↓
   Action Zone Card (stats bar, CTAs, refund note)
   ↓
   Form Fields (prompt template params or input schema)
   ↓
   Output Section (results display)
   ↓
   Divider
   ↓
   Tabs (Overview, API, Activity)
   ↓
   Related Jobs
   ```

5. **Clean up Overview tab**:
   - Remove Network row (already in action zone stats bar)
   - Remove Protocol/A2A row (already in action zone)
   - Keep Category, Currency, Agent, Service, Server rows
     </action>
     <verify>
6. TypeScript compiles: `cd /Users/rawgroundbeef/Projects/memeputer/apps/x402-jobs && npx tsc --noEmit 2>&1 | head -20`
7. Manual: Verify action zone card appears with stats bar + CTAs + refund note
8. Manual: Price appears ONLY in Run button, nowhere else
9. Manual: Refund badge shows tooltip on hover
10. Manual: Form fields still work for prompt templates and regular resources
11. Manual: Output section still displays results correctly
    </verify>
    <done>

- Action zone card groups stats, CTAs, and refund note
- Price appears only in Run button
- Refund badge merged with attribution in single line
- Redundant elements removed from header and overview tab
  </done>
  </task>

<task type="auto">
  <name>Task 2: Final cleanup and mobile responsiveness</name>
  <files>src/components/pages/ResourceDetailPage/ResourceDetailPage.tsx</files>
  <action>
Polish the layout for consistency and mobile responsiveness:

1. **Stats bar mobile handling**:
   - Ensure `flex-wrap` on stats bar for mobile
   - Items should wrap gracefully on narrow screens

2. **Remove any remaining redundant elements**:
   - Scan for duplicate price displays
   - Ensure network only appears once (in action zone)
   - Remove "per call" text since price context is clear from Run button

3. **Adjust spacing**:
   - Remove the old divider above "Try It Section" if still present
   - Ensure consistent spacing between sections
   - Header -> Action Zone should have natural gap (mb-8 on action zone handles this)

4. **Test mobile CTA layout**:
   - CTAs should stack or stay side-by-side based on width
   - Add responsive classes if needed: `flex-col sm:flex-row`

5. **Verify form + output placement**:
   - Form fields should appear AFTER action zone card
   - Output should appear after form fields
   - This maintains the flow: see info -> enter inputs -> see results

6. **Clean up any orphaned code**:
   - Remove unused imports (Play icon if no longer used in header stats)
   - Remove unused state/variables if any
     </action>
     <verify>
7. TypeScript compiles: `cd /Users/rawgroundbeef/Projects/memeputer/apps/x402-jobs && npx tsc --noEmit 2>&1 | head -20`
8. Manual: Test on mobile viewport (Chrome DevTools)
9. Manual: Stats bar wraps gracefully on narrow screens
10. Manual: CTAs remain usable on mobile
11. Manual: Full flow works: view page -> fill form -> run -> see output
    </verify>
    <done>

- Mobile responsiveness verified
- No redundant elements remain
- Clean imports and code
- Complete resource detail page redesign
  </done>
  </task>

</tasks>

<verification>
Complete page verification:
1. `npx tsc --noEmit` passes
2. Dev server runs without errors
3. Visual checks across scenarios:
   - Resource with high success rate (no warning)
   - Resource with low success rate (red warning)
   - Resource with refund support (shows merged badge)
   - Resource without refund support (no badge line)
   - As owner: see dropdown menu + earnings in stats
   - As visitor: no dropdown menu, no earnings shown
   - Mobile viewport: everything wraps and remains usable
4. Functional checks:
   - Edit from dropdown works
   - Delete from dropdown works
   - Run button executes resource
   - Use in Job creates job
   - Form validation still works
   - Output displays correctly
</verification>

<success_criteria>

1. Action zone card contains stats bar, CTAs, and refund note
2. Price appears ONLY in Run button (no duplication)
3. Refund badge merged with attribution in single tooltip line
4. Mobile responsive layout works correctly
5. All existing functionality preserved (run, create job, edit, delete)
6. No TypeScript errors
7. Clean, readable code without orphaned elements
   </success_criteria>

<output>
After completion, create `.planning/phases/08-resource-detail-redesign/08-02-SUMMARY.md`
</output>
