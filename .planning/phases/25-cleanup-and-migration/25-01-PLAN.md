---
phase: 25-cleanup-and-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/GlobalModals.tsx
  - apps/web/src/contexts/ModalContext.tsx
  - apps/web/src/app/dashboard/resources/page.tsx
  - apps/web/src/components/modals/CreateResourceModal.tsx
  - apps/web/src/components/modals/RegisterResourceModal.tsx
autonomous: true

must_haves:
  truths:
    - "CreateResourceModal component file no longer exists in the codebase"
    - "RegisterResourceModal component file no longer exists in the codebase"
    - "No file in apps/web/src imports CreateResourceModal or RegisterResourceModal"
    - "Dashboard edit button opens ResourceEditModal for basic field editing"
    - "ModalContext has no register resource state or callbacks"
    - "Application builds without errors"
  artifacts:
    - path: "apps/web/src/components/GlobalModals.tsx"
      provides: "Global modals without CreateResourceModal"
      contains: "No CreateResourceModal import or render"
    - path: "apps/web/src/contexts/ModalContext.tsx"
      provides: "Modal context without register resource state"
      contains: "No isRegisterResourceOpen or openRegisterResource"
    - path: "apps/web/src/app/dashboard/resources/page.tsx"
      provides: "Dashboard with ResourceEditModal for editing"
      contains: "ResourceEditModal"
  key_links:
    - from: "apps/web/src/app/dashboard/resources/page.tsx"
      to: "apps/web/src/components/modals/ResourceEditModal.tsx"
      via: "import and render for edit"
      pattern: "import.*ResourceEditModal"
---

<objective>
Remove the old CreateResourceModal and RegisterResourceModal, clean up ModalContext, and switch the dashboard edit flow to use ResourceEditModal.

Purpose: Complete the v2.0 wizard migration by removing all old modal code. The new wizard at `/dashboard/resources/new` handles all creation flows (Phases 19-24). Editing uses the existing ResourceEditModal for basic fields (name, slug, description, avatar).

Output: Clean codebase with no references to the old creation modals, ~3600 lines of dead code removed.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-cleanup-and-migration/25-RESEARCH.md

Key files to understand before modifying:
@apps/web/src/components/GlobalModals.tsx
@apps/web/src/contexts/ModalContext.tsx
@apps/web/src/app/dashboard/resources/page.tsx
@apps/web/src/components/modals/ResourceEditModal.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Switch dashboard edit to ResourceEditModal and remove CreateResourceModal imports</name>
  <files>
    apps/web/src/app/dashboard/resources/page.tsx
    apps/web/src/components/GlobalModals.tsx
    apps/web/src/contexts/ModalContext.tsx
  </files>
  <action>
    **dashboard/resources/page.tsx:**
    1. Replace the `import { CreateResourceModal }` (line 14) with `import { ResourceEditModal } from "@/components/modals/ResourceEditModal";`
    2. Keep the existing `editingResource` state and `setEditingResource` -- these work fine for ResourceEditModal
    3. Replace the `<CreateResourceModal>` block (lines 797-830) with a `<ResourceEditModal>` that maps the editingResource fields to ResourceEditModal's expected props:
       ```tsx
       {editingResource && (
         <ResourceEditModal
           isOpen={!!editingResource}
           onClose={() => setEditingResource(null)}
           resource={{
             id: editingResource.id,
             name: editingResource.name,
             slug: editingResource.slug,
             description: editingResource.description ?? undefined,
             server_slug: editingResource.server?.slug,
             avatar_url: editingResource.avatar_url ?? undefined,
           }}
           onSaved={() => {
             setEditingResource(null);
             fetchResources();
           }}
         />
       )}
       ```
    4. The ResourceEditModal interface expects: `{ id: string; name: string; slug?: string; description?: string; server_slug?: string; avatar_url?: string }` and `onSaved: (newSlug?: string) => void`. Map accordingly from the Resource interface. Note: `description` is `string | null` on Resource but `string | undefined` on ResourceEditModal, so use `?? undefined`.

    **GlobalModals.tsx:**
    1. Remove the `import { CreateResourceModal }` line (line 8)
    2. Remove the destructured variables from useModals(): `isRegisterResourceOpen`, `registerResourceOnSuccess`, `closeRegisterResource` (lines 31-33)
    3. Remove the `{/* Create Resource Modal */}` JSX block (lines 70-75)
    4. Keep all other modals and sidebars intact

    **ModalContext.tsx:**
    1. Remove from the `ModalContextValue` interface: `isRegisterResourceOpen`, `registerResourceOnSuccess`, `openRegisterResource`, `closeRegisterResource` (lines 72-76)
    2. Remove the state declarations: `isRegisterResourceOpen` useState (line 95) and `registerResourceOnSuccess` useState (lines 96-98)
    3. Remove the callback definitions: `openRegisterResource` useCallback (lines 125-128) and `closeRegisterResource` useCallback (lines 129-132)
    4. Remove from the Provider value object: `isRegisterResourceOpen`, `registerResourceOnSuccess`, `openRegisterResource`, `closeRegisterResource` (lines 153-156)
    5. Keep all other modal state (search, createJob, jobputerChat, resourceModal, myJobs) intact
  </action>
  <verify>
    Run: `cd /Users/rawgroundbeef/Projects/x402jobs && npx turbo build --filter=web`
    Build must succeed with no TypeScript errors about missing CreateResourceModal or register resource properties.

    Run: `grep -r "CreateResourceModal\|RegisterResourceModal\|isRegisterResourceOpen\|openRegisterResource" apps/web/src/ --include="*.tsx" --include="*.ts" -l`
    Must return ONLY the two modal files themselves (which still exist at this point), NOT any consumer files.
  </verify>
  <done>
    - GlobalModals.tsx no longer imports or renders CreateResourceModal
    - ModalContext.tsx has no register resource state, callbacks, or interface members
    - Dashboard resources page imports and renders ResourceEditModal instead of CreateResourceModal
    - The Edit dropdown item in the dashboard still opens a modal for basic field editing (name, slug, description, avatar)
    - No TypeScript errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Delete old modal files and verify clean codebase</name>
  <files>
    apps/web/src/components/modals/CreateResourceModal.tsx
    apps/web/src/components/modals/RegisterResourceModal.tsx
  </files>
  <action>
    1. Delete `apps/web/src/components/modals/CreateResourceModal.tsx` (3024 lines, 117KB)
    2. Delete `apps/web/src/components/modals/RegisterResourceModal.tsx` (622 lines, 23KB) -- this file has zero imports anywhere, confirmed dead code
    3. Run a full grep across the entire `apps/web/src` directory for any remaining references to:
       - `CreateResourceModal` (should be zero)
       - `RegisterResourceModal` (should be zero)
       - `isRegisterResourceOpen` (should be zero)
       - `openRegisterResource` (should be zero)
       - `closeRegisterResource` (should be zero)
       - `registerResourceOnSuccess` (should be zero)
    4. If any references found in code files (not .planning docs), fix them
    5. Run full build to confirm everything compiles
  </action>
  <verify>
    Run: `cd /Users/rawgroundbeef/Projects/x402jobs && npx turbo build --filter=web`
    Build must succeed.

    Run: `grep -r "CreateResourceModal\|RegisterResourceModal" apps/web/src/ --include="*.tsx" --include="*.ts"`
    Must return zero results.

    Run: `ls apps/web/src/components/modals/CreateResourceModal.tsx apps/web/src/components/modals/RegisterResourceModal.tsx 2>&1`
    Must show "No such file or directory" for both.
  </verify>
  <done>
    - CreateResourceModal.tsx deleted (~3024 lines removed)
    - RegisterResourceModal.tsx deleted (~622 lines removed)
    - Zero references to either modal remain in any .tsx/.ts file under apps/web/src
    - Application builds successfully
    - Total dead code removed: ~3646 lines
  </done>
</task>

</tasks>

<verification>
1. `npx turbo build --filter=web` succeeds with zero errors
2. `grep -r "CreateResourceModal" apps/web/src/ --include="*.tsx" --include="*.ts"` returns nothing
3. `grep -r "RegisterResourceModal" apps/web/src/ --include="*.tsx" --include="*.ts"` returns nothing
4. `grep -r "isRegisterResourceOpen\|openRegisterResource\|closeRegisterResource\|registerResourceOnSuccess" apps/web/src/ --include="*.tsx" --include="*.ts"` returns nothing
5. The files `CreateResourceModal.tsx` and `RegisterResourceModal.tsx` do not exist
6. Dashboard edit button still works (opens ResourceEditModal for name/slug/description/avatar editing)
</verification>

<success_criteria>
- CLNP-01 satisfied: CreateResourceModal component fully removed from codebase (file deleted, all imports removed)
- CLNP-02 satisfied: All entry points already route to `/dashboard/resources/new` (confirmed in Phase 19), and the only remaining CreateResourceModal usage (dashboard edit) is switched to ResourceEditModal
- Zero references to old modals remain in source code
- Application builds and runs without errors
- ~3646 lines of dead code removed
</success_criteria>

<output>
After completion, create `.planning/phases/25-cleanup-and-migration/25-01-SUMMARY.md`
</output>
