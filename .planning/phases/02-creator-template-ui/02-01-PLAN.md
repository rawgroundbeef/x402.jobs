---
phase: 02-creator-template-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/modals/CreateResourceModal.tsx
  - src/types/prompt-template.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Creator sees 'Prompt Template' as third option when clicking Create Resource"
    - "Creator can fill in basic fields (name, slug, description, image, category, price, network)"
    - "Form submission creates a prompt template resource in the database"
  artifacts:
    - path: "src/components/modals/CreateResourceModal.tsx"
      provides: "Prompt template type selection and basic form fields"
      contains: "prompt_template"
  key_links:
    - from: "CreateResourceModal.tsx"
      to: "types/prompt-template.ts"
      via: "import createPromptTemplateSchema"
      pattern: "createPromptTemplateSchema"
    - from: "CreateResourceModal.tsx"
      to: "/resources/instant"
      via: "authenticatedFetch POST"
      pattern: "resourceType.*prompt_template"
---

<objective>
Extend CreateResourceModal to support prompt template resource type selection and basic form fields.

Purpose: CRTR-01 (select Prompt Template) and CRTR-02 (name, description, image) and CRTR-06 (price) lay the foundation for the creator form. This plan adds the type card, basic form structure, and API submission without the complex system prompt editor or parameter management (those are Plan 02).

Output: Creator can select "Prompt Template" in Create Resource modal and fill in basic metadata fields. Form submits to API but parameters/system_prompt will be empty placeholders until Plan 02.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-creator-template-ui/02-CONTEXT.md
@.planning/phases/02-creator-template-ui/02-RESEARCH.md
@src/components/modals/CreateResourceModal.tsx
@src/types/prompt-template.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add prompt_template to ResourceType and type selection UI</name>
  <files>src/components/modals/CreateResourceModal.tsx</files>
  <action>
1. Update the ResourceType union to include "prompt_template":
   ```typescript
   type ResourceType = "external" | "proxy" | "prompt_template";
   ```

2. Add a third card in the type selection step (step === "select"):
   - Icon: FileText from lucide-react (import it at top)
   - Color: Use purple (bg-purple-500/10, text-purple-500) to distinguish from blue (external) and primary (proxy)
   - Title: "Prompt Template"
   - Description: "Monetize AI prompts with your own Claude templates"
   - onClick: handleSelectType("prompt_template")

3. Place the new card after the existing two cards in the grid. Keep the grid as 2 columns - the third card will wrap to the next row, which is fine for now.
   </action>
   <verify>

- Open the Create Resource modal
- Verify three type options are visible: "Register Existing", "Create New", "Prompt Template"
- Clicking "Prompt Template" should advance to form step (will show proxy form for now - expected)
  </verify>
  <done>Type selection shows all three resource types with distinct styling</done>
  </task>

<task type="auto">
  <name>Task 2: Create prompt template form with basic fields</name>
  <files>src/components/modals/CreateResourceModal.tsx, src/types/prompt-template.ts</files>
  <action>
1. Import the schema and type from prompt-template.ts:
   ```typescript
   import { createPromptTemplateSchema, CreatePromptTemplateInput } from "@/types/prompt-template";
   ```

2. Add a new react-hook-form instance for prompt templates (similar to proxyForm):

   ```typescript
   const promptTemplateForm = useForm<CreatePromptTemplateInput>({
     resolver: zodResolver(createPromptTemplateSchema),
     defaultValues: {
       name: "",
       slug: "",
       description: "",
       category: "",
       avatar_url: "",
       price_usdc: "0.01",
       network: "base",
       system_prompt: "", // Placeholder for Plan 02
       parameters: [], // Placeholder for Plan 02
       max_tokens: 4096,
       allows_user_message: false,
     },
   });
   ```

3. Update handleClose to reset promptTemplateForm:

   ```typescript
   promptTemplateForm.reset();
   ```

4. Add a new form section for when `step === "form" && resourceType === "prompt_template"`:
   - Follow the existing proxy form pattern but include only these fields for now:
     - Network selection (same pattern as proxy)
     - Name input with auto-slug generation (same pattern as proxy)
     - Slug input with availability check (same pattern as proxy)
     - Description textarea
     - Image upload using ImageUrlOrUpload
     - Category select
     - Price input (USDC) - use $0.01 minimum as per CONTEXT.md
   - Add placeholder comment: `{/* System prompt editor and parameters - Plan 02 */}`

5. Wire up slug checking for prompt templates:
   - Reuse existing handleNameChange and debouncedSlugCheck logic
   - The slug check should work identically to proxy resources

6. Update the dialog title for prompt_template:
   - When resourceType === "prompt_template", show "Create Prompt Template"
   - Use purple badge styling: bg-purple-500/10 text-purple-500
     </action>
     <verify>

- Select "Prompt Template" type
- Verify form shows: network, name, slug, description, image, category, price fields
- Type a name and verify slug auto-generates
- Change slug manually and verify availability check runs
- All fields should be editable and match the proxy form styling
  </verify>
  <done>Prompt template form displays with basic metadata fields matching existing patterns</done>
  </task>

<task type="auto">
  <name>Task 3: Wire form submission to API</name>
  <files>src/components/modals/CreateResourceModal.tsx</files>
  <action>
1. Create handleCreatePromptTemplate function (similar to handleCreateProxy):
   ```typescript
   const handleCreatePromptTemplate = async (data: CreatePromptTemplateInput) => {
     if (slugStatus && !slugStatus.available) {
       setError(slugStatus.reason || "Slug is not available");
       return;
     }

     setError("");
     setIsSubmitting(true);

     try {
       const body = {
         resourceType: "prompt_template",
         name: data.name.trim(),
         slug: data.slug.trim(),
         description: data.description?.trim() || null,
         priceUsdc: parseFloat(data.price_usdc),
         network: data.network,
         category: data.category,
         avatarUrl: data.avatar_url?.trim() || null,
         // Prompt template specific fields
         systemPrompt: data.system_prompt,
         parameters: data.parameters,
         maxTokens: data.max_tokens,
         allowsUserMessage: data.allows_user_message,
       };

       const res = await authenticatedFetch("/resources/instant", {
         method: "POST",
         headers: { "Content-Type": "application/json" },
         body: JSON.stringify(body),
       });

       if (!res.ok) {
         const responseData = await res.json();
         throw new Error(responseData.error || "Failed to create prompt template");
       }

       const responseData = await res.json();
       setCreatedResource({
         url: responseData.resource.url,
         slug: responseData.resource.slug,
       });
       setStep("success");
       onSuccess?.();
     } catch (err) {
       setError(err instanceof Error ? err.message : "Failed to create prompt template");
     } finally {
       setIsSubmitting(false);
     }

};

```

2. Update the DialogFooter to handle prompt_template type:
- Add a new condition: `step === "form" && resourceType === "prompt_template"`
- Show Cancel and Create buttons similar to proxy
- Button text: "Create Template" (or "Creating..." when submitting)
- Disable button if slug checking or unavailable (same logic as proxy)
- onSubmit: `promptTemplateForm.handleSubmit(handleCreatePromptTemplate)`

3. The form element should use onSubmit={promptTemplateForm.handleSubmit(handleCreatePromptTemplate)} pattern.

Note: The API endpoint may not yet support prompt_template. The form should still submit correctly - backend team will handle the endpoint. For now, submission will likely fail with "not implemented" or similar - that's expected and will be resolved when backend supports it.
</action>
<verify>
- Fill in all basic fields in the prompt template form
- Click "Create Template" button
- Form should submit (may fail if backend not ready - that's OK)
- Verify the request body in Network tab contains all fields with resourceType: "prompt_template"
- Error handling should display any errors in the UI
</verify>
<done>Form submission wired to API with correct payload structure for prompt templates</done>
</task>

</tasks>

<verification>
1. Type checking: `npm run typecheck` passes
2. Build: `npm run build` succeeds
3. Manual test:
- Open Create Resource modal
- See all three type options
- Select Prompt Template
- Fill in name, slug, description, image, category, price
- Submit form (may fail at API level - that's expected for now)
</verification>

<success_criteria>
- [ ] ResourceType union includes "prompt_template"
- [ ] Type selection shows three cards with distinct icons/colors
- [ ] Prompt template form displays all basic fields
- [ ] Auto-slug generation works for prompt templates
- [ ] Slug availability checking works for prompt templates
- [ ] Form submission sends correct JSON payload to /resources/instant
- [ ] Error handling displays API errors in UI
- [ ] TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-creator-template-ui/02-01-SUMMARY.md`
</output>
```
